#pollutants-codes: &pol_codes [7, 6001, 5, 8]
pollutants-codes:
- 6001
weather-features:
- tavg
- tmin
- tmax
- prcp
- wdir
- wspd
- wpgt
- pres
date-features:
- weekday
- day
- month
- year
- season
- is_weekend
- is_new_year
period-settings:
  date_start_train: &date_start_train '2015-01-01'
  date_prev_years_end: &date_prev_years_end '2022-12-31'
  date_current_year_start: &date_current_year_start '2023-01-01'
  current_date: &current_date '2023-06-17'
  last_run_date: &last_run_date '2023-02-12'

split_periods:
#  train_date_to: '2023-04-30'
  #val_date_to: '2023-06-17'
  val_date_to: '2023-05-17'
  forecast_period: &forecast_period 7
  remove_days_at_start: 90

weather-station: &weather-station '06344'

country-code: &country-code NL

city: &city Rotterdam

stations_per_pollutants: &stations_per_pollutants
#  '7': 'STA-NL00418'
#  '5': 'STA-NL00418'
  '6001': STA-NL00448
#  '8': 'STA-NL00418'

download-weather-cur-year:
  station_id: *weather-station
  date_from: *date_current_year_start
  date_to: *current_date

download-weather-prev-years:
  station_id: *weather-station
  date_from: *date_start_train
  date_to: *date_prev_years_end

download-pollutants-cur-year:
  country_code: *country-code
  city: *city
  stations_per_pollutants: *stations_per_pollutants
  date_from: *date_current_year_start
  date_to: *current_date

download-pollutants-prev-years:
  country_code: *country-code
  city: *city
  stations_per_pollutants: *stations_per_pollutants
  date_from: *date_start_train
  date_to: *date_prev_years_end

outliers-aqi:
  iqr_borders:
    6001:
    - 100
    - 100
enrich-pollutants: &enrich-pollutants
  lags-shifts:
  - 7
  - 8
  - 9
  - 10
  - 14
  - 21
  - 28
  filters:
  - weekday
  - month
  windows_filters_aqi:
    NoFilter:
    - 3D
    - 5D
    - 7D
    - 14D
    - 28D
    weekday:
    - 28D
    - 56D
    month:
    - 90D
  lag_agg_aqi:
  - 7
  - 10
  - 14
  - 21
  - 28
  methods_agg_aqi:
  - mean
  - median
  - percentile(10)
  - percentile(90)
  ewm_filters_aqi:
    NoFilter:
    - 7
    - 14
    - 21
    - 28
    weekday:
    - 28
    - 56
    month:
    - 90
enrich-pollutants-prev-years:
  params: *enrich-pollutants
  date_prev_from: *date_start_train
  date_prev_to: *date_prev_years_end

enrich-pollutants-cur-year:
  params: *enrich-pollutants
  date_prev_from: *date_start_train
  date_prev_to: *date_prev_years_end
  date_cur_from: *date_current_year_start
  date_cur_to: *current_date

metric: &metric rmse

optuna:
  objective: &objective regression
  n_trials: 200
  n_jobs: 8
  cv_folders: 16
  optimization_direction: minimize

columns_filters_gen: &columns_filters_gen
  use_aqi_cols: true
  use_c_mean_cols: false
  use_c_max_cols: false
  use_c_median_cols: false
  use_c_min_cols: false
  use_pol_cols: false
  use_lag_cols: false
  use_gen_lags_cols: true
  use_weather_cols: true
  pollutants_codes:
  - 6001
  weather_columns:
  - tavg
  - tmin
  - tmax
  - prcp
  - wdir
  - wspd
  - wpgt
  - pres
  date_columns:
  - weekday
  - day
  - month
  - year
  - season
  - is_weekend
  - is_new_year

lgbm_pm25:
  exp_name: lgbm_pm25
  run_name: outliers_no_weather_no
  pol_id: 6001
  categories:
  - month
  - weekday
  default_category:
  - month
  - weekday
  search_category: false
  default_top_features_count: 30
  default_params:
    n_jobs: -1
    verbosity: -1
    objective: *objective
    metric: *metric
    boosting_type: gbdt
    extra_trees: true
    n_estimators: 2100
    num_leaves: 100
    learning_rate: 0.01
    subsample: 0.7
    subsample_freq: 5
    subsample_for_bin: 100000
    min_child_samples: 30
    reg_alpha: 0.1
    reg_lambda: 0.3
    max_depth: 10
    max_bin: 200
  prediction_value_type: AQI
  columns_filters: *columns_filters_gen
  columns_selected:
  - AQI_PM25
  - month
  - weekday
  - Wx
  - Wy
  - tmin
  - prcp
  - AQI_PM25_lag21d_win7D_agmean_filtNoFilter
  - AQI_PM25_lag7d_win7D_agpercentile(10)_filtNoFilter
  - AQI_PM25_lag7d_win3D_agpercentile(90)_filtNoFilter
  - AQI_PM25_lag10d_win3D_agmedian_filtNoFilter
  - AQI_PM25_lag10d_ewm7_filtNoFilter
  - AQI_PM25_lag28d_win28D_agmean_filtNoFilter
  - AQI_PM25_lag7d_ewm21_filtNoFilter
  - AQI_PM25_lag7d_win14D_agpercentile(90)_filtNoFilter
  - AQI_PM25_lag21d_win14D_agmedian_filtNoFilter
  - AQI_PM25_lag10d_win14D_agpercentile(90)_filtNoFilter
  - AQI_PM25_lag7d_win5D_agmean_filtNoFilter
  - AQI_PM25_lag21d_win28D_agpercentile(10)_filtNoFilter
  - AQI_PM25_lag7d_win28D_agpercentile(90)_filtweekday
  - AQI_PM25_lag21d_ewm56_filtweekday

tft_pm25:
  exp_name: tft_pm25
  run_name: outliers_no
  pol_id: 6001
  prediction_value_type: AQI

  dataset_params:
    max_prediction_length: *forecast_period
    max_encoder_length: 28
    batch_size: 64
    group_ids:
      - Pollutant
    static_reals:
      - year
    time_varying_known_categoricals:
      - month
      - weekday
    time_varying_known_reals:
      - Wx
      - Wy
      - tmin
      - prcp

  trainer_params:
      max_epochs: 50
      gradient_clip_val: 0.1
      limit_train_batches: 50

  tft_params:
      learning_rate: 0.1
      hidden_size: 16
      attention_head_size: 2
      dropout: 0.1
      hidden_continuous_size: 8
      log_interval: 10
      optimizer: Ranger
      reduce_on_plateau_patience: 4
